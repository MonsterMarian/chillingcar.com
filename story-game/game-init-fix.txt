<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chronicles of Fate - Fixed</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,400;0,600;0,700;1,400&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
/* Base Styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: "Inter", sans-serif;
  background-color: #0a0a12;
  color: #e0e0ff;
  min-height: 100vh;
  overflow-x: hidden;
}

.screen {
  display: none;
  min-height: 100vh;
  position: relative;
  opacity: 0;
  transition: opacity 0.8s ease;
}

.screen.active {
  display: block;
  opacity: 1;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 2rem;
  position: relative;
  z-index: 20;
}

.background-gradient {
  position: fixed;
  inset: 0;
  background: radial-gradient(ellipse at 20% 80%, rgba(139, 69, 19, 0.15) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 20%, rgba(75, 0, 130, 0.1) 0%, transparent 50%),
    linear-gradient(to bottom, #0a0a12, #0f0f1a 50%, #0a0a12);
  z-index: 1;
}

.map-screen .container {
  padding-top: 4rem;
}

.map-header {
  text-align: center;
  margin-bottom: 3rem;
  animation: header-fade-in 1s ease-out;
}

@keyframes header-fade-in {
  0% {
    opacity: 0;
    transform: translateY(-30px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

.map-title {
  font-family: "Crimson Pro", serif;
  font-size: 3rem;
  font-weight: 700;
  color: #e0e0ff;
  margin-bottom: 0.5rem;
  text-shadow: 0 0 40px rgba(255, 107, 53, 0.3);
}

.map-subtitle {
  color: #a0a0c0;
  font-size: 1rem;
  letter-spacing: 0.1em;
  text-transform: uppercase;
}

.map-legend {
  display: flex;
  justify-content: center;
  gap: 2rem;
  margin-bottom: 1.5rem;
  padding: 1rem;
  background: rgba(20, 20, 35, 0.5);
  border-radius: 12px;
  border: 1px solid rgba(255, 255, 255, 0.05);
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.85rem;
  color: #a0a0c0;
}

.legend-dot {
  width: 12px;
  height: 12px;
  border-radius: 50%;
}

.legend-dot.main {
  background: linear-gradient(135deg, #ff6b35, #f7931e);
  box-shadow: 0 0 10px rgba(255, 107, 53, 0.5);
}

.legend-dot.bonus {
  background: linear-gradient(135deg, #a855f7, #7c3aed);
  box-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
}

.map-container {
  position: relative;
  width: 100%;
  height: 500px;
  background: rgba(20, 20, 35, 0.5);
  border-radius: 20px;
  border: 1px solid rgba(255, 255, 255, 0.05);
  margin-bottom: 1.5rem;
  overflow: hidden;
}

.map-paths {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
}

.map-path {
  stroke-dasharray: 10 5;
  animation: path-flow 2s linear infinite;
}

@keyframes path-flow {
  0% { stroke-dashoffset: 0; }
  100% { stroke-dashoffset: -30; }
}

.map-locations {
  position: absolute;
  inset: 0;
}

.location-node {
  position: absolute;
  transform: translate(-50%, -50%);
  text-align: center;
  cursor: default;
  transition: all 0.4s ease;
}

.node-badge {
  position: absolute;
  top: -25px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 0.6rem;
  font-weight: 700;
  letter-spacing: 0.1em;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  white-space: nowrap;
  z-index: 2;
}

.node-badge.main {
  background: linear-gradient(135deg, #ff6b35, #f7931e);
  color: white;
}

.node-badge.bonus {
  background: linear-gradient(135deg, #a855f7, #7c3aed);
  color: white;
}

.location-node.available {
  cursor: pointer;
}

.location-node.available:hover {
  transform: translate(-50%, -50%) scale(1.1);
}

.node-icon {
  width: 60px;
  height: 60px;
  background: rgba(30, 30, 50, 0.9);
  border: 2px solid rgba(255, 107, 53, 0.5);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  margin: 0 auto 0.5rem;
  position: relative;
  z-index: 1;
  transition: all 0.3s ease;
}

.location-node.completed .node-icon {
  border-color: rgba(74, 222, 128, 0.7);
  box-shadow: 0 0 20px rgba(74, 222, 128, 0.3);
}

.location-node.available .node-icon {
  animation: node-pulse 2s infinite ease-in-out;
}

@keyframes node-pulse {
  0%, 100% { box-shadow: 0 0 15px rgba(255, 107, 53, 0.3); }
  50% { box-shadow: 0 0 30px rgba(255, 107, 53, 0.6); }
}

.location-node.locked .node-icon {
  border-color: rgba(100, 100, 120, 0.3);
  filter: grayscale(1);
  opacity: 0.5;
}

.location-node.bonus-road .node-icon {
  border-color: rgba(168, 85, 247, 0.5);
}

.location-node.bonus-road.available .node-icon {
  animation: bonus-pulse 2s infinite ease-in-out;
}

@keyframes bonus-pulse {
  0%, 100% { box-shadow: 0 0 15px rgba(168, 85, 247, 0.3); }
  50% { box-shadow: 0 0 30px rgba(168, 85, 247, 0.6); }
}

.location-node.bonus-road.completed .node-icon {
  border-color: rgba(168, 85, 247, 0.7);
  box-shadow: 0 0 20px rgba(168, 85, 247, 0.3);
}

.node-label {
  font-weight: 600;
  color: #e0e0ff;
  font-size: 0.9rem;
  margin-bottom: 0.25rem;
  white-space: nowrap;
}

.node-status {
  font-size: 0.7rem;
  color: #a0a0c0;
  text-transform: uppercase;
  letter-spacing: 0.1em;
}

.location-node.completed .node-status {
  color: #4ade80;
}

.location-node.available .node-status {
  color: #ff6b35;
}

.map-info-card {
  background: rgba(20, 20, 35, 0.7);
  border: 1px solid rgba(255, 255, 255, 0.05);
  border-radius: 16px;
  padding: 1.5rem 2rem;
  text-align: center;
}

.map-info-card h3 {
  font-family: "Crimson Pro", serif;
  font-size: 1.5rem;
  color: #e0e0ff;
  margin-bottom: 0.5rem;
}

.map-info-card p {
  color: #a0a0c0;
  font-size: 0.9rem;
  line-height: 1.6;
}

.map-bottom-buttons {
  position: fixed;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 1rem;
  z-index: 100;
}

.nav-button {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
  background: rgba(20, 20, 40, 0.8);
  backdrop-filter: blur(10px);
  border: 2px solid;
  border-radius: 16px;
  padding: 1rem 1.5rem;
  min-width: 140px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-family: "Inter", sans-serif;
}

.nav-button:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
}

.main-button {
  border-color: #ff6b35;
  color: #ff6b35;
}

.main-button:hover {
  background: rgba(255, 107, 53, 0.15);
  box-shadow: 0 8px 25px rgba(255, 107, 53, 0.3);
}

.bonus-button {
  border-color: #a855f7;
  color: #a855f7;
}

.bonus-button:hover {
  background: rgba(168, 85, 247, 0.15);
  box-shadow: 0 8px 25px rgba(168, 85, 247, 0.3);
}

.button-icon {
  font-size: 1.5rem;
}

.button-text {
  font-size: 0.9rem;
  font-weight: 500;
  text-align: center;
}

.debug-panel {
  position: fixed;
  top: 1rem;
  right: 1rem;
  background: rgba(20, 20, 40, 0.95);
  border: 1px solid rgba(255, 107, 53, 0.5);
  border-radius: 12px;
  padding: 1rem;
  z-index: 1000;
  font-size: 0.85rem;
  max-width: 300px;
}

.debug-panel h4 {
  color: #ff6b35;
  margin-bottom: 0.5rem;
}

.debug-panel button {
  margin: 0.25rem;
  padding: 0.25rem 0.5rem;
  background: rgba(255, 107, 53, 0.2);
  border: 1px solid #ff6b35;
  border-radius: 4px;
  color: #e0e0ff;
  cursor: pointer;
  font-size: 0.75rem;
}

.debug-panel button:hover {
  background: rgba(255, 107, 53, 0.3);
}

@media (max-width: 640px) {
  .map-title {
    font-size: 2rem;
  }

  .map-container {
    height: 400px;
  }

  .node-icon {
    width: 50px;
    height: 50px;
    font-size: 1.2rem;
  }
}
    </style>
</head>
<body>
    <div class="background-gradient"></div>
    
    <!-- Map Screen -->
    <div class="screen map-screen active" id="mapScreen">
        <div class="container">
            <div class="map-header">
                <h1 class="map-title">Mapa P≈ô√≠bƒõhu</h1>
                <p class="map-subtitle">Vyber si svou cestu</p>
            </div>
            
            <div class="map-legend">
                <div class="legend-item">
                    <div class="legend-dot main"></div>
                    <span>Hlavn√≠ p≈ô√≠bƒõh</span>
                </div>
                <div class="legend-item">
                    <div class="legend-dot bonus"></div>
                    <span>Bonus kapitola</span>
                </div>
            </div>
            
            <div class="map-container">
                <svg class="map-paths" viewBox="0 0 100 100" preserveAspectRatio="none">
                    <path class="map-path" d="M15,50 Q17,35 20,20" stroke="rgba(255,107,53,0.4)" stroke-width="0.5" fill="none"/>
                    <path class="map-path" d="M20,20 L40,20" stroke="rgba(255,107,53,0.4)" stroke-width="0.5" fill="none"/>
                    <path class="map-path" d="M40,20 L60,20" stroke="rgba(255,107,53,0.4)" stroke-width="0.5" fill="none"/>
                    <path class="map-path" d="M60,20 L80,20" stroke="rgba(255,107,53,0.4)" stroke-width="0.5" fill="none"/>
                    <path class="map-path" d="M80,20 Q70,35 50,50" stroke="rgba(255,107,53,0.4)" stroke-width="0.5" fill="none"/>
                    <path class="map-path" d="M50,50 Q50,65 50,80" stroke="rgba(255,107,53,0.4)" stroke-width="0.5" fill="none"/>
                </svg>
                
                <div class="map-locations">
                    <div class="location-node completed" data-location="start" style="left: 15%; top: 50%;">
                        <div class="node-icon">üéÆ</div>
                        <div class="node-label">Start</div>
                        <div class="node-status">Dokonƒçeno</div>
                    </div>
                    
                    <div class="location-node available" data-location="napoleon" style="left: 20%; top: 20%;">
                        <span class="node-badge main">MAIN</span>
                        <div class="node-icon">ü§™</div>
                        <div class="node-label">Napoleon</div>
                        <div class="node-status">Dostupn√©</div>
                    </div>
                    
                    <div class="location-node bonus-road locked" data-location="freaky_comix" style="left: 40%; top: 20%;">
                        <span class="node-badge bonus">BONUS</span>
                        <div class="node-icon">üé®</div>
                        <div class="node-label">Freaky Comix</div>
                        <div class="node-status">Zamƒçeno</div>
                    </div>
                    
                    <div class="location-node locked" data-location="jednou_vetou" style="left: 60%; top: 20%;">
                        <span class="node-badge main">MAIN</span>
                        <div class="node-icon">üí¨</div>
                        <div class="node-label">Jednou vƒõtou</div>
                        <div class="node-status">Zamƒçeno</div>
                    </div>
                    
                    <div class="location-node bonus-road locked" data-location="site_video" style="left: 80%; top: 20%;">
                        <span class="node-badge bonus">BONUS</span>
                        <div class="node-icon">üì°</div>
                        <div class="node-label">S√≠tƒõ Video</div>
                        <div class="node-status">Zamƒçeno</div>
                    </div>
                    
                    <div class="location-node locked" data-location="nektera_proc" style="left: 30%; top: 50%;">
                        <span class="node-badge main">MAIN</span>
                        <div class="node-icon">üî•</div>
                        <div class="node-label">Nƒõkter√° proƒç...</div>
                        <div class="node-status">Zamƒçeno</div>
                    </div>
                    
                    <div class="location-node bonus-road locked" data-location="pudinkovy_pribeh" style="left: 50%; top: 50%;">
                        <span class="node-badge bonus">BONUS</span>
                        <div class="node-icon">üçÆ</div>
                        <div class="node-label">Pudinkov√Ω p≈ô√≠bƒõh</div>
                        <div class="node-status">Zamƒçeno</div>
                    </div>
                    
                    <div class="location-node bonus-road locked" data-location="kviz" style="left: 70%; top: 50%;">
                        <span class="node-badge bonus">BONUS</span>
                        <div class="node-icon">‚ú®</div>
                        <div class="node-label">Kv√≠z</div>
                        <div class="node-status">Zamƒçeno</div>
                    </div>
                    
                    <div class="location-node locked" data-location="konec" style="left: 50%; top: 80%;">
                        <span class="node-badge main">MAIN</span>
                        <div class="node-icon">üéâ</div>
                        <div class="node-label">Konec</div>
                        <div class="node-status">Zamƒçeno</div>
                    </div>
                </div>
            </div>
            
            <div class="map-info-card" id="mapInfoCard">
                <h3>Vyber kapitolu</h3>
                <p>Klikni na dostupnou lokaci pro pokraƒçov√°n√≠ v p≈ô√≠bƒõhu.</p>
            </div>
            
            <div class="map-bottom-buttons" id="mapBottomButtons">
                <button class="nav-button main-button" id="mainRouteButton" style="display: none;">
                    <span class="button-icon">üõ£Ô∏è</span>
                    <span class="button-text">Hlavn√≠ cesta</span>
                </button>
                <button class="nav-button bonus-button" id="bonusRouteButton" style="display: none;">
                    <span class="button-icon">‚ú®</span>
                    <span class="button-text">Bonusov√° cesta</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Debug Panel -->
    <div class="debug-panel">
        <h4>üõ†Ô∏è Debug Panel</h4>
        <p style="margin-bottom: 0.5rem;">Completed: <span id="debugCompleted">start</span></p>
        <div style="margin-top: 0.5rem;">
            <button onclick="completeChapter('napoleon')">‚úÖ Napoleon</button>
            <button onclick="completeChapter('jednou_vetou')">‚úÖ Jednou</button>
            <button onclick="completeChapter('freaky_comix')">‚úÖ Freaky</button>
            <button onclick="completeChapter('nektera_proc')">‚úÖ Proƒç</button>
            <button onclick="completeChapter('site_video')">‚úÖ Video</button>
            <button onclick="completeChapter('kviz')">‚úÖ Kv√≠z</button>
            <button onclick="completeChapter('pudinkovy_pribeh')">‚úÖ Pudink</button>
            <button onclick="resetProgress()">üîÑ Reset</button>
        </div>
    </div>

    <script>
// Game State
window.gameState = {
  currentLocation: "start",
  currentScene: 0,
  completedLocations: ["start"]
}

// Check if location is available
function isAvailable(location) {
  const completed = window.gameState.completedLocations

  switch (location) {
    case "start":
      return true
    case "napoleon":
      return completed.includes("start")
    case "jednou_vetou":
      return completed.includes("napoleon")
    case "freaky_comix":
      return completed.includes("jednou_vetou")
    case "nektera_proc":
      return completed.includes("freaky_comix")
    case "site_video":
      return completed.includes("nektera_proc")
    case "kviz":
      return completed.includes("site_video")
    case "pudinkovy_pribeh":
      return completed.includes("kviz")
    case "konec":
      return completed.includes("pudinkovy_pribeh")
    default:
      return false
  }
}

// Update map nodes based on game state
window.updateMapNodes = () => {
  const nodes = document.querySelectorAll(".location-node")
  const completed = window.gameState.completedLocations

  nodes.forEach((node) => {
    const location = node.dataset.location
    const statusEl = node.querySelector(".node-status")

    node.classList.remove("completed", "available", "locked")

    if (completed.includes(location)) {
      node.classList.add("completed")
      if (statusEl) statusEl.textContent = "Dokonƒçeno"
    } else if (isAvailable(location)) {
      node.classList.add("available")
      if (statusEl) statusEl.textContent = "Dostupn√©"
    } else {
      node.classList.add("locked")
      if (statusEl) statusEl.textContent = "Zamƒçeno"
    }
  })

  updateBottomButtons()
  updateDebugPanel()
}

// Update bottom navigation buttons
function updateBottomButtons() {
  const mainButton = document.getElementById("mainRouteButton")
  const bonusButton = document.getElementById("bonusRouteButton")
  
  if (!mainButton || !bonusButton) return
  
  mainButton.style.display = "none"
  bonusButton.style.display = "none"
  
  const completed = window.gameState.completedLocations
  
  let nextMainLocation = null
  const mainRouteOrder = ["start", "napoleon", "jednou_vetou", "nektera_proc", "konec"]
  
  for (let i = 0; i < mainRouteOrder.length - 1; i++) {
    const currentLoc = mainRouteOrder[i]
    const nextLoc = mainRouteOrder[i + 1]
    
    if (completed.includes(currentLoc) && !completed.includes(nextLoc) && isAvailable(nextLoc)) {
      nextMainLocation = nextLoc
      break
    }
  }
  
  let availableBonusLocation = null
  const bonusLocations = [
    { id: "freaky_comix", unlocksAfter: "jednou_vetou" },
    { id: "site_video", unlocksAfter: "nektera_proc" },
    { id: "kviz", unlocksAfter: "site_video" },
    { id: "pudinkovy_pribeh", unlocksAfter: "kviz" }
  ]
  
  for (const bonus of bonusLocations) {
    if (completed.includes(bonus.unlocksAfter) && !completed.includes(bonus.id) && isAvailable(bonus.id)) {
      availableBonusLocation = bonus.id
      break
    }
  }
  
  if (nextMainLocation) {
    const locationNames = {
      "napoleon": "Napoleon",
      "jednou_vetou": "Jednou vƒõtou",
      "nektera_proc": "Nƒõkter√° proƒç...",
      "konec": "Konec"
    }
    
    mainButton.querySelector(".button-text").textContent = locationNames[nextMainLocation] || nextMainLocation
    mainButton.onclick = () => alert(`Would travel to: ${nextMainLocation}`)
    mainButton.style.display = "flex"
  }
  
  if (availableBonusLocation) {
    const locationNames = {
      "freaky_comix": "Freaky Comix",
      "site_video": "S√≠tƒõ Video",
      "pudinkovy_pribeh": "Pudinkov√Ω p≈ô√≠bƒõh",
      "kviz": "Kv√≠z"
    }
    
    bonusButton.querySelector(".button-text").textContent = locationNames[availableBonusLocation] || availableBonusLocation
    bonusButton.onclick = () => alert(`Would travel to: ${availableBonusLocation}`)
    bonusButton.style.display = "flex"
  }
}

// Setup node clicks
function setupNodeClicks() {
  const nodes = document.querySelectorAll(".location-node")

  nodes.forEach((node) => {
    node.addEventListener("click", () => {
      if (!node.classList.contains("available")) return

      const location = node.dataset.location
      if (location === "start") return

      alert(`Would start chapter: ${location}`)
    })
  })
}

// Debug functions
function completeChapter(chapterId) {
  if (!window.gameState.completedLocations.includes(chapterId)) {
    window.gameState.completedLocations.push(chapterId)
    window.updateMapNodes()
  }
}

function resetProgress() {
  window.gameState.completedLocations = ["start"]
  window.updateMapNodes()
}

function updateDebugPanel() {
  const debugCompleted = document.getElementById("debugCompleted")
  if (debugCompleted) {
    debugCompleted.textContent = window.gameState.completedLocations.join(", ")
  }
}

// Initialize
document.addEventListener("DOMContentLoaded", () => {
  setTimeout(() => {
    setupNodeClicks()
    window.updateMapNodes()
  }, 100)
})
    </script>
</body>
</html>